---
layout: post
title: '[CVPR 2022] Point-to-Voxel Knowledge Distillation for LiDAR Semantic Segmentation'
date: 2025-02-23 15:00 +0800
last_modified_at: 2025-02-23 15:00 +0800
tags: [jekyll theme, jekyll, tutorial]
toc:  true
---

## Introduction
- LiDAR 의미론적 분할은 자율주행 차량의 인식에 중요한 역할을 하며, 딥 러닝의 발전으로 많은 LiDAR 분할 모델이 제안되었지만, 이들 모델은 과도한 계산 및 저장 비용으로 인해 리소스가 제한된 장치에 배포하기 어려움.
- 그러나 기존의 증류 알고리즘을 LiDAR 분할에 직접 적용하면 포인트 클라우드의 희소성, 무작위성 및 다양한 밀도로 인해 한계가 있음.
- 이를 해결하기 위해 우리는 PVD(Point-to-Voxel Knowledge Distillation)를 제안.
- PVD는 포인트 수준과 복셀 수준에서 지식을 추출하여 교사의 포인트별 및 복셀별 확률적 출력을 활용
- 포인트별 출력은 세분화된 지각 정보를, 복셀별 예측은 환경에 대한 풍부한 단서를 포함



## Related work

###  LiDAR semantic segmentation
- 이러한 네트워크가 리소스가 제한된 장치에 배포하기에는 너무 번거롭다는 것입니다. 이러한 강력하지만 번거로운 LiDAR 의미론적 분할 모델을 실제 응용 프로그램에 배포할 수 있도록 모델 압축을 달성하기 위한 point-voxel 지식 증류를 제안

### Knowledge distillation
- 이전 증류 알고리즘은 2D 분할에서 뛰어난 성능을 보여주었지만 이를 LiDAR 분할 작업에 직접 배포하면 포인트 클라우드의 고유한 희소성, 무작위성 및 다양한 밀도로 인해 약간의 이득을 얻을 수 있음. 
그리고 우리는 최고의 지식을 바탕으로 LiDAR 의미론적 분할에 지식 증류를 적용한 최초의 기업


## Methodology

본 논문의 KD 방법은 Cylinder3D 모델을 기반으로 함.
- 입력으로 포인트 클라우드를 받아 각 포인트에 대한 특징을 MLP를 통해 생성
- 생성된 포인트 특징은 원통형 분할을 기반으로 재할당
- 같은 복셀에 속하는 포인트 특징들은 맥스풀링 연산을 통해 집계되어 복셀 특징을 얻음.
- 이 복셀 특징들은 비대칭 3D 컨볼루션 네트워크에 입력되어 복셀 단위의 출력을 생성
- 포인트 단위의 예측을 정제하기 위해 포인트 단위 정제 모듈을 사용하여 정제된 포인트 단위 예측을 생성
- 마지막으로, argmax 연산을 통해 각 포인트의 분류 결과를 얻음.


### Point-to-Voxel Output Distillation
- 이전의 증류 접근법[10, 17]은 일반적으로 Teacher 네트워크의 최종 출력, 즉 LiDAR 의미론적 분할을 위한 Teacher 네트워크의 점별 출력을 증류하는 데 의존
- 포인트별 출력에는 환경에 대한 세밀한 인식 정보가 포함되어 있지만 이러한 지식은 수십만 개의 포인트가 있기 때문에 학습에는 비효율적
- 학습 효율성을 높이기 위해 점별 출력 외에도 복셀 수가 적고 학습하기 쉽기 때문에 복셀별 출력을 증류하는 것을 제안

Labels for the voxelwise output: 복셀에는 다양한 클래스의 포인트가 포함될 수 있으므로 복셀에 적절한 레이블을 할당하는 방법도 성능에 중요 복셀 내부의 최대 포인트 수를 갖는 클래스 레이블을 복셀 레이블로 사용하는 다수 인코딩 전략을 채택


### Point-to-Voxel Affinity Distillation

Supervoxel partition
- 관계형 지식을 보다 효율적으로 학습하기 위해 전체 포인트 클라우드를 여러 슈퍼 복셀로 나눔.  각 슈퍼 복셀은 고정된 수의 복셀로 구성된다.

Difficulty-aware sampling: 
- 빈도가 낮은 클래스와 멀리 있는 객체를 포함하는 슈퍼 복셀을 샘플링할 가능성을 높이기 위해 난이도 인식 샘플링 전략을 제시
- 전체 데이터 세트의 모든 포인트 중 1% 이상을 차지하는 클래스를 다수 클래스로 처리하고 나머지 클래스는 소수 클래스로 간주

Point/voxel features processing
- 입력 포인트 수와 포인트 특징/복셀 특징 밀도는 포인트 클라우드마다 다를 수 있으므로 각 슈퍼복셀의 특징 수가 다양해짐.
- feature 수를 고정된 상태로 유지하기 위해 유지된 포인트 feature과 비어 있지 않은 복셀 feature의 수를 각각 Np 및 Nv로 설정하고, 포인트 feature의 수가 Np보다 크면 다수 클래스의 추가 포인트 feature을 무작위로 삭제. - 더 작은 경우 Np feature을 얻기 위해 모두 0인 feature을 추가
- 점 간 친화도 행렬은 정규화된 점 특징 간의 코사인 유사성을 기반으로 계산되어 학생 모델에서 학습할 구조적 지식을 포착
- 포인트 간 친화력 증류 손실과 복셀 간 친화력 증류 손실은 Student 모델이 Teacher 모델에 의해 생성된 친화력 행렬을 모방하도록 만드는 데 사용

### Visualization of the learned affinity maps

- PVD를 사용하면 동일한 클래스에 속하는 기능은 더 가까이 당겨지고 다른 클래스의 기능은 기능 공간에서 멀리 밀려나므로 훨씬 명확한 친화력 맵이 생성됨.

### Final objective
최종 손실 함수는 포인트별 출력 및 복셀별 출력에 대한 가중 교차 엔트로피 손실, lovasz-softmax 손실[2], 포인트-복셀 출력 증류 손실 및 포인트-복셀 친화성 증류의 7개 항으로 구성
